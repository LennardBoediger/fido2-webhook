// Copyright 2019 SoloKeys Developers
//
// Licensed under the Apache License, Version 2.0, <LICENSE-APACHE or
// http://apache.org/licenses/LICENSE-2.0> or the MIT license <LICENSE-MIT or
// http://opensource.org/licenses/MIT>, at your option. This file may not be
// copied, modified, or distributed except according to those terms.
#include <stdint.h>
#include "crypto.h"
#include "memory_layout.h"

const uint8_t attestation_solo_cert_der[] =
"\x30\x82\x02\xd6\x30\x82\x02\x7d\xa0\x03\x02\x01\x02\x02\x01\x01\x30\x0a\x06\x08"
"\x2a\x86\x48\xce\x3d\x04\x03\x02\x30\x7a\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13"
"\x02\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c\x12\x4e\x69\x74\x72\x6f\x6b"
"\x65\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31\x10\x30\x0e\x06\x03\x55\x04"
"\x0b\x0c\x07\x52\x6f\x6f\x74\x20\x43\x41\x31\x1a\x30\x18\x06\x03\x55\x04\x03\x0c"
"\x11\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x20\x54\x45\x53\x54\x31\x20"
"\x30\x1e\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x11\x69\x6e\x66\x6f\x40"
"\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x30\x20\x17\x0d\x31\x39\x31\x32"
"\x30\x33\x31\x37\x31\x38\x33\x34\x5a\x18\x0f\x32\x30\x36\x39\x31\x31\x32\x30\x31"
"\x37\x31\x38\x33\x34\x5a\x30\x81\x8c\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02"
"\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c\x12\x4e\x69\x74\x72\x6f\x6b\x65"
"\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31\x22\x30\x20\x06\x03\x55\x04\x0b"
"\x0c\x19\x41\x75\x74\x68\x65\x6e\x74\x69\x63\x61\x74\x6f\x72\x20\x41\x74\x74\x65"
"\x73\x74\x61\x74\x69\x6f\x6e\x31\x1a\x30\x18\x06\x03\x55\x04\x03\x0c\x11\x6e\x69"
"\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x20\x54\x45\x53\x54\x31\x20\x30\x1e\x06"
"\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x11\x69\x6e\x66\x6f\x40\x6e\x69\x74"
"\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d"
"\x02\x01\x06\x08\x2a\x86\x48\xce\x3d\x03\x01\x07\x03\x42\x00\x04\xac\xba\x04\x3d"
"\x33\x1d\xda\x29\xe5\x3d\x76\xa9\x65\x55\xfb\xa6\x1a\x52\xcf\x64\x86\x78\x0e\x63"
"\x7c\x61\xbb\x3c\x54\x14\x91\xb0\x55\xe6\x1d\xa2\x5d\x1e\x9e\xbd\x8e\x5b\x89\x40"
"\x35\xbe\x3c\x67\x9e\x71\x22\x4a\x3f\xe0\x04\xac\x8a\x77\xe9\x9d\x91\xa4\x9e\x2f"
"\xa3\x81\xde\x30\x81\xdb\x30\x1d\x06\x03\x55\x1d\x0e\x04\x16\x04\x14\x0a\xcd\x9c"
"\x0e\xae\x8a\xa5\xb9\xb1\x4d\x31\x3c\x19\x5e\x23\x1d\x80\xbe\xe7\x03\x30\x81\xa1"
"\x06\x03\x55\x1d\x23\x04\x81\x99\x30\x81\x96\xa1\x7e\xa4\x7c\x30\x7a\x31\x0b\x30"
"\x09\x06\x03\x55\x04\x06\x13\x02\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c"
"\x12\x4e\x69\x74\x72\x6f\x6b\x65\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31"
"\x10\x30\x0e\x06\x03\x55\x04\x0b\x0c\x07\x52\x6f\x6f\x74\x20\x43\x41\x31\x1a\x30"
"\x18\x06\x03\x55\x04\x03\x0c\x11\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d"
"\x20\x54\x45\x53\x54\x31\x20\x30\x1e\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01"
"\x16\x11\x69\x6e\x66\x6f\x40\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x82"
"\x14\x32\x17\xfd\xcc\xf9\xf0\xd0\xe3\x6a\xe4\xd1\xe8\x59\x68\x67\x64\x02\x4b\xba"
"\x89\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04"
"\x04\x03\x02\x04\xf0\x30\x0a\x06\x08\x2a\x86\x48\xce\x3d\x04\x03\x02\x03\x47\x00"
"\x30\x44\x02\x20\x78\x94\xe8\x14\xdc\x4a\xcc\xce\x07\x8c\x42\xdf\x0d\xef\x77\x43"
"\xd8\xe3\xb7\x35\x4c\xc0\x42\x4a\xef\x4d\x1a\x0a\x69\x9e\xce\x99\x02\x20\x1a\xde"
"\x83\x9b\xe3\x0c\x68\x30\xff\x38\xbe\x73\x79\xe2\xbe\x26\x1b\x80\xe5\xce\xa3\xdf"
"\x90\xde\x10\x4e\x4b\xb1\x62\x90\xdd\xf7"
;

const uint8_t attestation_hacker_cert_der[] =
"\x30\x82\x02\xd6\x30\x82\x02\x7d\xa0\x03\x02\x01\x02\x02\x01\x01\x30\x0a\x06\x08"
"\x2a\x86\x48\xce\x3d\x04\x03\x02\x30\x7a\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13"
"\x02\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c\x12\x4e\x69\x74\x72\x6f\x6b"
"\x65\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31\x10\x30\x0e\x06\x03\x55\x04"
"\x0b\x0c\x07\x52\x6f\x6f\x74\x20\x43\x41\x31\x1a\x30\x18\x06\x03\x55\x04\x03\x0c"
"\x11\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x20\x54\x45\x53\x54\x31\x20"
"\x30\x1e\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x11\x69\x6e\x66\x6f\x40"
"\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x30\x20\x17\x0d\x31\x39\x31\x32"
"\x30\x33\x31\x37\x31\x38\x33\x34\x5a\x18\x0f\x32\x30\x36\x39\x31\x31\x32\x30\x31"
"\x37\x31\x38\x33\x34\x5a\x30\x81\x8c\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02"
"\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c\x12\x4e\x69\x74\x72\x6f\x6b\x65"
"\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31\x22\x30\x20\x06\x03\x55\x04\x0b"
"\x0c\x19\x41\x75\x74\x68\x65\x6e\x74\x69\x63\x61\x74\x6f\x72\x20\x41\x74\x74\x65"
"\x73\x74\x61\x74\x69\x6f\x6e\x31\x1a\x30\x18\x06\x03\x55\x04\x03\x0c\x11\x6e\x69"
"\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x20\x54\x45\x53\x54\x31\x20\x30\x1e\x06"
"\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x11\x69\x6e\x66\x6f\x40\x6e\x69\x74"
"\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d"
"\x02\x01\x06\x08\x2a\x86\x48\xce\x3d\x03\x01\x07\x03\x42\x00\x04\xac\xba\x04\x3d"
"\x33\x1d\xda\x29\xe5\x3d\x76\xa9\x65\x55\xfb\xa6\x1a\x52\xcf\x64\x86\x78\x0e\x63"
"\x7c\x61\xbb\x3c\x54\x14\x91\xb0\x55\xe6\x1d\xa2\x5d\x1e\x9e\xbd\x8e\x5b\x89\x40"
"\x35\xbe\x3c\x67\x9e\x71\x22\x4a\x3f\xe0\x04\xac\x8a\x77\xe9\x9d\x91\xa4\x9e\x2f"
"\xa3\x81\xde\x30\x81\xdb\x30\x1d\x06\x03\x55\x1d\x0e\x04\x16\x04\x14\x0a\xcd\x9c"
"\x0e\xae\x8a\xa5\xb9\xb1\x4d\x31\x3c\x19\x5e\x23\x1d\x80\xbe\xe7\x03\x30\x81\xa1"
"\x06\x03\x55\x1d\x23\x04\x81\x99\x30\x81\x96\xa1\x7e\xa4\x7c\x30\x7a\x31\x0b\x30"
"\x09\x06\x03\x55\x04\x06\x13\x02\x44\x45\x31\x1b\x30\x19\x06\x03\x55\x04\x0a\x0c"
"\x12\x4e\x69\x74\x72\x6f\x6b\x65\x79\x20\x47\x6d\x62\x48\x20\x54\x45\x53\x54\x31"
"\x10\x30\x0e\x06\x03\x55\x04\x0b\x0c\x07\x52\x6f\x6f\x74\x20\x43\x41\x31\x1a\x30"
"\x18\x06\x03\x55\x04\x03\x0c\x11\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d"
"\x20\x54\x45\x53\x54\x31\x20\x30\x1e\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01"
"\x16\x11\x69\x6e\x66\x6f\x40\x6e\x69\x74\x72\x6f\x6b\x65\x79\x2e\x63\x6f\x6d\x82"
"\x14\x32\x17\xfd\xcc\xf9\xf0\xd0\xe3\x6a\xe4\xd1\xe8\x59\x68\x67\x64\x02\x4b\xba"
"\x89\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04"
"\x04\x03\x02\x04\xf0\x30\x0a\x06\x08\x2a\x86\x48\xce\x3d\x04\x03\x02\x03\x47\x00"
"\x30\x44\x02\x20\x78\x94\xe8\x14\xdc\x4a\xcc\xce\x07\x8c\x42\xdf\x0d\xef\x77\x43"
"\xd8\xe3\xb7\x35\x4c\xc0\x42\x4a\xef\x4d\x1a\x0a\x69\x9e\xce\x99\x02\x20\x1a\xde"
"\x83\x9b\xe3\x0c\x68\x30\xff\x38\xbe\x73\x79\xe2\xbe\x26\x1b\x80\xe5\xce\xa3\xdf"
"\x90\xde\x10\x4e\x4b\xb1\x62\x90\xdd\xf7"
;


const uint16_t attestation_solo_cert_der_size = sizeof(attestation_solo_cert_der)-1;
const uint16_t attestation_hacker_cert_der_size = sizeof(attestation_hacker_cert_der)-1;

uint8_t solo_hacker_attestation_key[32] = "\x1b\x26\x26\xec\xc8\xf6\x9b\x0f\x69\xe3\x4f"
                                          "\xb2\x36\xd7\x64\x66\xba\x12\xac\x16\xc3\xab"
                                          "\x57\x50\xba\x06\x4e\x8b\x90\xe0\x24\x48";

// const uint16_t attestation_key_size = 32;
const uint8_t * attestation_cert_der = ((flash_attestation_page *)ATTESTATION_PAGE_ADDR)->attestation_cert;

#include "log.h"
uint16_t attestation_cert_der_get_size(){
    uint16_t sz = (uint16_t)((flash_attestation_page *)ATTESTATION_PAGE_ADDR)->attestation_cert_size;
    return sz;
}

